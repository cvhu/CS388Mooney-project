This invention includes methods for identifying nucleic acids in a sample of nucleic acids by observing sequence sets present in the nucleic acids of the sample and then identifying those sequences in a nucleic acid sequence database having the sequence sets observed. In a preferred embodiment, a sequence set consists of two primary subsequences and an additional subsequence having determined mutual relationships. The methods include those for observing the sequence sets and those for performing sequence database searches. This invention also includes devices for recognizing in parallel the additional subsequences in a sample of as well as methods for the use of these devices. In a preferred embodiment, the devices include probes bound to a planar surface that recognize additional subsequence by hybridization, and the methods of use include features to improve the specificity and reproducibility of this hybridization.
Claims What is claimed is: 1. A method for identifying nucleic acids in a sample of nucleic acids comprising: (a) observing subsequence sets present in said sample of nucleic acids, wherein a subsequence set comprises at least a first primary nucleotide subsequence, a second primary nucleotide subsequence, and an additional nucleotide subsequence, and wherein said additional nucleotide subsequence is spaced apart from said first primary nucleotide subsequence by a fixed distance of zero or more nucleotides which is the same in all subsequence sets and said second primary nucleotide subsequence is not adjacent to either said additional nucleotide subsequence or said first primary subsequence and wherein said second primary nucleotide subsequence is spaced apart from said additional nucleotide subsequence by one or more nucleotides; and wherein said step of observing comprises the steps of: (i) providing at least one subsample of one or more species of first nucleic acid fragments, said species of first nucleic acid fragments in said subsample being derived from those nucleic acids in said sample, selected sequences for said first primary nucleotide subsequences and said second primary nucleotide subsequences having been chosen for said sample; and (ii) determining the sequence of said additional nucleotide subsequence in each said species of first nucleic acid fragments of said subsample; and (b) searching a database of nucleic acid sequences in order to locate database sequences having said observed subsequence sets or to determine that no such database sequences exist, said database of nucleic acid sequences comprising nucleic acid sequences that might be present in said sample; wherein a database sequence has a particular observed subsequence set (i) if it has the first primary nucleotide subsequence, the second primary nucleotide subsequence, and the additional nucleotide subsequence of the particular observed subsequence set, (ii) if the additional nucleotide subsequence is spaced apart from the first primary nucleotide subsequence by the same fixed distance as in the particular observed subsequence set, and (iii) if said second primary nucleotide subsequence is spaced apart from said additional nucleotide subsequence by one or more nucleotides; thereby identifying said located database sequences as sequences of nucleic acids present in said sample. 2. The method of claim 1 wherein said fixed distance is zero nucleotides. 3. The method of claim 1 wherein the length of said first primary nucleotide subsequence is at least six nucleotides, the length of said second primary nucleotide subsequence is at least six nucleotides, and the length of said additional nucleotide subsequence is at least four nucleotides. 4. The method of claim 1 wherein the length of said first primary nucleotide subsequence is six nucleotides, the length of said second primary nucleotide subsequence is six nucleotides, and the length of said additional nucleotide subsequence is at least six nucleotides. 5. The method of claim 1 wherein the length of said first primary nucleotide sequence, the length of said second primary nucleotide sequence, and the length of said additional nucleotide sequence are chosen such that on average a particular subsequence set occurs in less than approximately 10 sequences in said sequence database. 6. The method of claim 1 wherein the length of said first primary nucleotide sequence, the length of said second primary nucleotide sequence, and the length of said additional nucleotide sequence are chosen such that on average a particular subsequence set occurs in less than approximateLy 5 sequences in said sequence database. 7. The method of claim 1 wherein said providing step provides a plurality of subsamples, each subsample having different selected sequences for said first primary nucleotide subsequence or said second primary nucleotide subsequence. 8. The method of claim 1 wherein the length of said first primary nucleotide sequence, the length of said second primary nucleotide sequence, and the length of said additional nucleotide sequence are chosen such that on average the number of species of first nucleic acid fragments in said subsample is less than the number of possible sequences for said additional nucleotide subsequences. 9. The method of claim 1 wherein said first and said second primary nucleotide subsequences are sequences of recognition sites of restriction endonucleases of a type that cuts nucleic acids within their recognition sites, and wherein said providing step comprises digesting said sample with restriction endonucleases whose recognition sites have the sequences selected for said first and second primary nucleotide subsequences. 10. A The method of claim 9 wherein said providing step further comprises, after said digesting, the steps of (i) hybridizing digested nucleic acids with adapter nucleic acids, said adapter nucleic acids being partially double-stranded, each said adapter nucleic acid being complementary to an end of a nucleic acid digested by one of said restriction endonucleases, and (ii) ligating said hybridized nucleic acids and adapter nucleic acids. 11. A method for identifying nucleic acids in a sample of nucleic acids comprising: (a) observing subsequence sets present in said sample of nucleic acids, wherein a subsequence set comprises at least a first primary nucleotide subsequence, a second primary nucleotide subsequence, and an additional nucleotide subsequence, and wherein said additional nucleotide subsequence is spaced apart from said first primary nucleotide subsequence by a fixed distance of zero or more nucleotides which is the same in all subsequence sets and said second primary nucleotide subsequence is not adjacent to either said additional nucleotide subsequence or said first primary subsequence and wherein said second primary nucleotide subsequence is spaced apart from said additional nucleotide subsequence by one or more nucleotides; and wherein said step of observing comprises the steps of: (i) providing at least one subsample of one or more species of first nucleic acid fragments, said species of first nucleic acid fragments in said subsample being derived from those nucleic acids in said sample, selected sequences for said first primary nucleotide subsequences and said second primary nucleotide subsequences having been chosen for said sample; and (ii) determining the sequence of said additional nucleotide subsequence in each said species of first nucleic acid fragments of said subsample; wherein said determining step comprises: (A) producing second nucleic acid fragments from said first nucleic acid fragments of said subsample, wherein said second nucleic acid fragments have a single-stranded terminal nucleotide subsequence, and wherein said additional nucleotide subsequence comprises said single-stranded terminal nucleotide subsequence; (B) hybridizing a plurality of species of probe molecules with said second nucleic acid fragments, probe molecules of each of said species of probe molecules capable of hybridizing with said second nucleic acid fragments having a particular sequence for said additional nucleotide subsequence; and (C) detecting which of said species of probe molecules has hybridized with said second nucleic acid fragments; whereby the sequences of said additional nucleotide sequences are determined; and (b) searching a database of nucleic acid sequences in order to locate database sequences having said observed subsequence sets or to determine that no such database sequences exist, said database of nucleic acid sequences comprising nucleic acid sequences that might be present in said sample; wherein a database sequence has a particular observed subsequence set (i) if it has the first primary nucleotide subsequence, the second primary nucleotide subsequence, and the additional nucleotide subsequence of the particular observed subsequence set, (ii) if the additional nucleotide subsequence is spaced apart from the first primary nucleotide subsequence by the same fixed distance as in the particular observed subsequence set, and (iii) if said second primary nucleotide subsequence is spaced apart from said additional nucleotide subsequence by one or more nucleotides; thereby identifying said located database sequences as sequences of nucleic acids present in said sample. 12. The method of claim 11 wherein said species of probe molecules are fixed on a surface in an arrangement such that each species of probe molecule occupies a discrete observational region of said surface separate from regions occupied by other species of probe molecules. 13. The method of claim 11 further comprising, before said detecting step, a step of washing said probe molecules hybridized with said second nucleic acid fragments at a stringency to remove mis-hybridized or non-specifically bound second nucleic acid fragments. 14. The method of claim 11 wherein said second fragments are labeled with a detectable moiety. 15. The method of claim 14 wherein said detectable moiety is a fluorescent moiety or a moiety recognizable by an antibody conjugated to a detectable moiety. 16. The method of claim 11 wherein said producing step comprises digesting said fragments in said subsample with a restriction endonuclease of a type that cuts nucleic acids outside of its recognition site. 17. The method of claim 11 wherein said probe molecules comprise a peptido-nucleic acid subsequence, such that for each species of said probe molecule the sequence of said peptido-nucleic acid subsequence is complementary to the sequence of said additional subsequence hybridizable to said species of probe molecules. 18. The method of claim 11 wherein each of said probe molecules comprises a nucleotide sequence, which in turn comprises a hybridization region nucleotide subsequence and a core nucleotide subsequence, the sequence of said hybridization region nucleotide subsequence being complementary to the sequence of said additional subsequence hybridizable to said species of probe molecules, said core nucleotide subsequence being adjacent to said hybridization region nucleotide subsequence, and wherein said step of hybridizing comprises: (a) hybridizing a plurality of species of probe molecules with said second nucleic acid fragments and with stacking oligomers to form a hybridization structure, the sequence of said stacking oligomers being complementary to a hybridizable portion of the sequence of said core nucleotide subsequence of said probe molecules, said hybridizable portion being adjacent to said hybridization region nucleotide subsequence; and (b) ligating nicks in said hybridization structure. 19. The method of claim 18 wherein said additional nucleotide subsequence consists of said single-stranded terminal nucleotide subsequence of said second nucleic acid fragments. 20. The method of claim 18 wherein said additional nucleotide subsequence comprises said single-stranded terminal nucleotide subsequence of said second nucleic acid fragments and a double-stranded nucleotide subsequence of said second nucleic acid fragments, said double-stranded terminal nucleotide subsequence being adjacent to said single-stranded nucleotide subsequence. 21. The method of claim 18 wherein said stacking oligomers are labeled with a detectable moiety. 22. The method of claim 21 wherein said detectable moiety comprises a fluorescent energy transfer dye. 23. The method of claim 22 wherein said fluorescent energy transfer dye comprises a donor moiety and an acceptor moiety, and wherein one of said donor or said acceptor moieties is not conjugated to said stacking oligomer. 24. The method of claim 18 wherein said second nucleic acid fragments are labeled with a detectable moiety. 25. The method of claim 24 wherein said detectable moiety comprises a fluorescent energy transfer dye, wherein said fluorescent energy transfer dye comprises a donor moiety and an acceptor moiety, and wherein one of said donor or said acceptor moieties is not conjugated to said second nucleic acid fragments. 26. The method of claim 18 wherein said hybridizing and said ligating steps are (i) performed under conditions such that the concentration of said second nucleic acid fragments is less than concentrations of said probe molecules, and (ii) stopped before said second nucleic acid fragments become depleted. 27. The method of claim 11 wherein said detecting step additionally detects the amount of said second nucleic acid fragments hybridized with said species of probe molecule. 28. The method of claim 1 further comprising, after said determining step, a step of amplifying one or more species of first nucleic acid fragments in said subsample by contacting said subsample with a nucleic acid polymerase and one or more primers, at least one primer being a phasing primer which comprises a subsequence with the same sequence as one of said determined additional subsequences. 29. The method of claim 28 further comprising, after said amplifying step, a step of sequencing at least a portion of one or more nucleic acid products of said amplifying step. 30. The method of claim 29 wherein said determined sequences are compared with said located database sequences that contain a sequence set comprising said selected first primary nucleotide sequence, said selected first primary nucleotide sequences, and said determined additional subsequence. 31. The method of claim 30 further comprising, after said amplifying and searching steps, storing the results of said amplifying in a permanent storage. 32. The method of claim 1 wherein said searching step further comprises examining individually and sequentially each sequence in the sequence database for the presence of a sequence set. 33. The method of claim 1 wherein said searching step comprises representing a sequence set as a regular expression in order to search sequences in the sequence database. 34. The method of claim 1 further comprising, prior to said searching step, a step of constructing an index of subsequences present in the sequences of said sequence database, and wherein said searching step consults said index of subsequences. 35. The method of claim 1 further comprising, after said searching step, a step of storing said located sequences in a permanent computer-readable storage. 36. The method of claim 35 where said step of storing stores along with said located sequences additional information describing said sample of nucleic acids. 37. The method of claim 35 wherein said step of observing further observes the amount of nucleic acids in said sample having said observed subsequence sets, and wherein said step of storing stores along with said located sequences said observed amount. 38. A method for identifying and quantifying nucleic acids in a sample of nucleic acids comprising: (a) providing at least one subsample of first nucleic acid fragments, said first nucleic acid fragments in said subsample being derived from those nucleic acids in said sample in which a first primary nucleotide subsequence and a second primary nucleotide subsequence have selected sequences, wherein said first and said second primary nucleotide subsequences are not contiguous in said nucleic acids; (b) producing second nucleic acid fragments having a single-stranded terminal nucleotide subsequence from said subsample of first nucleic acid fragments; (c) determining a sequence for an additional nucleotide subsequence of said second nucleic acid fragments, said additional nucleotide subsequence comprising said single-stranded terminal nucleotide subsequence, and wherein said single-stranded nucleotide subsequence is spaced apart from said first primary nucleotide subsequence by a distance of zero or more nucleotides which is the same in all second nucleic acid fragments, said determining by: (i) hybridizing a plurality of species of probe molecules with said second nucleic acid fragments, each of said species of probe molecules capable of hybridizing with said second nucleic acid fragments having a particular sequence for said additional nucleotide subsequence, and (ii) detecting which of said species of probe molecules has hybridized with said second nucleic acid fragments, and the amount of said second nucleic acid fragments hybridized with said species of probe molecule; (d) searching a database of nucleic acid sequences in order to locate database sequences having said selected first primary subsequence, said selected second primary subsequence, and said determined additional subsequence or to determine that no such database sequences exist, said database of nucleic acid sequences comprising nucleic acid sequences that might be present in said sample; wherein a database sequence has a particular observed subsequence set (i) if it has the first primary nucleotide subsequence, the second primary nucleotide subsequence, and the additional nucleotide subsequence of the particular observed subsequence set, (ii) if the additional nucleotide subsequence is spaced apart from the first primary nucleotide subsequence by the same fixed distance as in the particular observed subsequence set, and (iii) if said second primary nucleotide subsequence is spaced apart from said additional nucleotide subsequence by one or more nucleotides; thereby identifying said located database sequences as sequences of nucleic acids present in said sample. 39. The method of claim 38 wherein said probe molecules comprise a nucleotide sequence, which in turn comprises a hybridization region nucleotide subsequence and a core nucleotide subsequence, the sequence of said hybridization region nucleotide subsequence being complementary to the sequence of said additional subsequence hybridizable to said species of probe molecules, said core nucleotide subsequence being adjacent to said hybridization region nucleotide subsequence, and wherein said step of hybridizing comprises: (a) hybridizing a plurality of species of probe molecules with said second nucleic acid fragments and with stacking oligomers to form a hybridization structure, the sequence of said stacking oligomers being complementary to a hybridizable portion of the sequence of said core nucleotide subsequence of said probe molecules, said hybridizable portion being adjacent to said hybridization region nucleotide subsequence; and (b) ligating nicks in said hybridization structure. 40. The method of claim 38 wherein said additional nucleotide subsequence consists of said single-stranded terminal nucleotide subsequence of said second nucleic acid fragments. 41. The method of claim 38 wherein said additional nucleotide subsequence comprises said single-stranded terminal nucleotide subsequence of said second nucleic acid fragments and a double-stranded nucleotide subsequence of said second nucleic acid fragments, said double-stranded terminal nucleotide subsequence being adjacent to said single-stranded nucleotide subsequence. 42. A method for differential gene expression analysis comprising: (a) applying the method of claim 1 to a nucleic acid sample derived from a first tissue; (b) applying the method of claim 1 to a nucleic acid sample derived from a second tissue; and (c) comparing the nucleic acids identified in step (a) with the nucleic acids identified in step (b). 43. The method of claim 42 wherein said first tissue comprises a particular tissue in a first state, and wherein said second tissue comprises said particular tissue in a second state. 44. The method of claim 12 wherein said species of probe molecules are in a detection array, said array comprising: (a) one or more surfaces; and (b) a plurality of discrete observational cells arranged on said surfaces in which are bound probe molecules, each probe molecule being a member of one of a plurality of species of probe molecules, wherein each discrete observational cell has bound probe molecules of at most one species, and wherein said probe molecules comprise: (i) a hybridization region, wherein said hybridization region of said probe molecules of one species of probe molecule are capable of hybridizing with said terminal subsequences of said target nucleic acids having a single nucleotide sequence, (ii) a core region adjacent to and conjugated with said hybridization region, and (iii) an attachment means for binding said hybridization region and said core region to said surfaces. 45. The method of claim 44 wherein said array further comprises a plurality of discrete error-checking cells to which are bound probe molecules, wherein to each discrete error-checking cell are bound probe molecules of a plurality of species, such that each species of probe molecule is bound to one discrete observational cell and to at least one discrete error-checking cell. 