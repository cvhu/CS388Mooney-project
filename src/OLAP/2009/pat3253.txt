A facial expression recognition system that uses a face detection apparatus realizing efficient learning and high-speed detection processing based on ensemble learning when detecting an area representing a detection target and that is robust against shifts of face position included in images and capable of highly accurate expression recognition, and a learning method for the system, are provided. When learning data to be used by the face detection apparatus by Adaboost, processing to select high-performance weak hypotheses from all weak hypotheses, then generate new weak hypotheses from these high-performance weak hypotheses on the basis of statistical characteristics, and select one weak hypothesis having the highest discrimination performance from these weak hypotheses, is repeated to sequentially generate a weak hypothesis, and a final hypothesis is thus acquired. In detection, using an abort threshold value that has been learned in advance, whether provided data can be obviously judged as a non-face is determined every time one weak hypothesis outputs the result of discrimination. If it can be judged so, processing is aborted. A predetermined Gabor filter is selected from the detected face image by an Adaboost technique, and a support vector for only a feature quantity extracted by the selected filter is learned, thus performing expression recognition.
Claims What is claimed is: 1. A learning apparatus for learning data to be used by a detection apparatus, the detection apparatus being adapted for judging whether provided data is a detection target or not by using a data set including plural learning samples each of which has data weighting set thereon and has been labeled as a detection target or non-detection target, the learning apparatus comprising: one or more programmable central processing units, and a computer-readable storage medium encoded with instructions executable by at least one of the central processing units and operatively coupled to at least one or the central processing units, the instructions comprising instructions that comprise a weak hypothesis generation unit for generating a weak hypothesis for estimating whether provided data is a detection target or not, instructions that comprise a reliability calculation unit for calculating reliability of the weak hypothesis on the basis of the result of estimation of the weak hypothesis generated by the weak hypothesis generation unit with respect to the data set, and instructions that comprise a data weighting update unit for updating the data weighting in such a manner that the data weighting of a learning sample on which estimation by the weak hypothesis generated by the weak hypothesis generation unit is incorrect becomes relatively larger than the data weighting of a learning sample on which estimation is correct; wherein the weak hypothesis generation unit comprises a selection unit for selecting a part of plural weak hypotheses and selecting one or plural weak hypotheses having higher estimation performance with respect to the data set from the selected part of the weak hypotheses, as high-performance weak hypotheses, a threshold value learning unit for calculating and adding the product of the result of estimation of the weak hypothesis with respect to the data set and the reliability of the weak hypothesis every time a weak hypothesis is selected by the weak hypothesis selection unit and learning an abort threshold value for aborting the processing by the detection apparatus to judge whether the provided data is a detection target or not on the basis of the result of the addition, a new weak hypothesis generation unit for generating one or more new weak hypotheses by adding a predetermined modification to the high-performance weak hypotheses, and a weak hypothesis selection unit for selecting one weak hypothesis having the highest estimation performance with respect to the data set from the high-performance weak hypotheses and the new weak hypotheses, the weak hypothesis generation unit repeating processing to generate a weak hypothesis every time the data weighting is updated by the data weighting update unit; and wherein the threshold value learning unit learns the abort threshold value on the basis of the result of addition of the product of the result of estimation of the weak hypothesis with respect to positive data labeled as the detection target, of the data set, and the reliability of the weak hypothesis, calculated and added every time a weak hypothesis is selected by the weak hypothesis selection unit. 2. A learning apparatus for learning data to be used by a detection apparatus, the detection apparatus being adapted for judging whether provided data is a detection target or not by using a data set including plural learning samples each of which has been labeled as a detection target or non-detection target, the learning apparatus comprising: one or more programmable central processing units; and a computer-readable storage medium encoded with instructions executable by at least one of the central processing units and operatively coupled to at least one or the central processing units, the instructions comprising instructions that comprise a weak hypothesis selection unit for repeating processing to select one weak hypothesis from plural weak hypotheses for estimating whether provided data is a detection target or not, instructions that comprise a reliability calculation unit for, every time a weak hypothesis is selected by the weak hypothesis selection unit, calculating reliability of the weak hypothesis on the basis of the result of estimation of the selected weak hypothesis with respect to the data set, and instructions that comprise a threshold value learning unit for calculating and adding the product of the result of estimation of the weak hypothesis with respect to the data set and the reliability of the weak hypothesis every time a weak hypothesis is selected by the weak hypothesis selection unit and learning an abort threshold value for aborting the processing by the detection apparatus to judge whether the provided data is a detection target or not on the basis of the result of the addition. 3. The learning apparatus as claimed in claim 2, wherein: the computer-readable storage medium is encoded with instructions that comprise a data weighting update unit for, every time the weak hypothesis is selected, updating the data weighting in such a manner that the data weighting of a learning sample on which estimation by the selected weak hypothesis is incorrect becomes relatively larger than the data weighting of a learning sample on which estimation is correct, and the weak hypothesis selection unit repeats processing to select the weak hypothesis every time the data weighting is updated. 4. The learning apparatus as claimed in claim 2, wherein the threshold value learning unit learns the abort threshold value on the basis of the result of addition of the product of the result of estimation of the weak hypothesis with respect to positive data labeled as the detection target, of the data set, and the reliability of the weak hypothesis, calculated and added every time a weak hypothesis is selected by the weak hypothesis selection unit. 5. The learning apparatus as claimed in claim 4, wherein the threshold value learning unit stores a smaller one of a minimum value of the result of addition with respect to the positive data and a discrimination boundary value, as the abort threshold value, every time the weak hypothesis is selected. 6. The learning apparatus as claimed in claim 2, wherein the threshold value learning unit learns the abort threshold value on the basis of the result of addition of the product of the result of estimation of the weak hypothesis with respect to negative data labeled as the non-detection target, of the data set, and the reliability of the weak hypothesis, calculated and added every time a weak hypothesis is selected by the weak hypothesis selection unit. 7. The learning apparatus as claimed in claim 6, wherein the threshold value learning unit stores a larger one of a maximum value of the result of calculation with respect to the negative data and a discrimination boundary value, as the abort threshold value, every time the weak hypothesis is selected. 8. A learning method for learning data to be used by a detection apparatus, the detection apparatus being adapted for judging whether provided data is a detection target or not by using a data set including plural learning samples each of which has been labeled as a detection target or non-detection target, the learning method being performed by an apparatus that comprises one or more programmable central processing units and a computer-readable storage medium that is operatively coupled to at least one of the central processing units and is encoded with instructions capable of being executed by at least one of the central processing units, the method comprising: at least one of the central processing units executing instructions, retrieved from the computer-readable storage medium, that cause the central processing unit to perform a weak hypothesis selection step of repeating processing to select one weak hypothesis from plural weak hypotheses for estimating whether provided data is a detection target or not; at least one of the central processing units executing instructions, retrieved from the computer-readable storage medium, that cause the central processing unit to perform a reliability calculation step of, every time a weak hypothesis is selected at the weak hypothesis selection step, calculating reliability of the weak hypothesis on the basis of the result of estimation of the selected weak hypothesis with respect to the data set; and at least one of the central processing units executing instructions, retrieved from the computer-readable storage medium, that cause the central processing unit to perform a threshold value learning step of calculating and adding the product of the result of estimation of the weak hypothesis with respect to the data set and the reliability of the weak hypothesis every time a weak hypothesis is selected at the weak hypothesis selection step, and learning an abort threshold value for aborting the processing by the detection apparatus to judge whether the provided data is a detection target or not on the basis of the result of the addition. 