A novel framework for fast and continuous registration between two imaging modalities is disclosed. The approach makes it possible to completely determine the rigid transformation between multiple sources at real-time or near real-time frame-rates in order to localize the cameras and register the two sources. A disclosed example includes computing or capturing a set of reference images within a known environment, complete with corresponding depth maps and image gradients. The collection of these images and depth maps constitutes the reference source. The second source is a real-time or near-real time source which may include a live video feed. Given one frame from this video feed, and starting from an initial guess of viewpoint, the real-time video frame is warped to the nearest viewing site of the reference source. An image difference is computed between the warped video frame and the reference image. The viewpoint is updated via a Gauss-Newton parameter update and certain of the steps are repeated for each frame until the viewpoint converges or the next video frame becomes available. The final viewpoint gives an estimate of the relative rotation and translation between the camera at that particular video frame and the reference source. The invention has far-reaching applications, particularly in the field of assisted endoscopy, including bronchoscopy and colonoscopy. Other applications include aerial and ground-based navigation.
Claims The invention claimed is: 1. A system for registering images associated with a continuously guided endoscopic procedure, comprising: a memory storing a plurality of reference images of a body lumen, each reference image including a viewpoint with a depth map and image gradients; a connector adapted for connection to an endoscope for receiving therefrom one or more live video frames associated with a body lumen; and a processor operative to register each video frame received from the endoscope to at least one of the reference images, the processor being programmed to perform the steps of: a) warping the video frame to the viewpoint of one reference image of the plurality of reference images or warping one reference image of the plurality of reference images at a viewpoint to the video frame; b) automatically computing an image difference between (i) the warped video frame and the reference image, or (ii) the warped reference image and the video frame; c) updating a viewpoint of the video frame using an optimization technique; and d) repeating steps a) through c) for each video frame until the viewpoint of the video frame converges on a final viewpoint or a next video frame becomes available. 2. The system of claim 1, wherein at least one reference image is updated before, during, or after registration. 3. The system of claim 1, wherein the processor is further operative to receive a guess regarding an initial viewpoint of the video frame. 4. The system of claim 1, wherein the final viewpoint gives an estimate of the relative rotation and translation between the video frame of the video feed and the reference image. 5. The system of claim 1, wherein the processor is further operative to use a resolution pyramid wherein all images, depth maps, and gradients are down-sampled. 6. The system of claim 1, further including the step of using a weighted normalized cross-correlation objective function. 7. The system of claim 1, wherein the optimization technique is based on a Gauss-Newton parameter update. 8. The system of claim 1, wherein the computed set of reference images of a body lumen comprises a 3-D model of a bronchial tree. 9. The system of claim 1 further comprising an endoscope to which the connector is connected. 10. The system of claim 1 further comprising a bronchoscope to which the connector is connected. 11. A system for registering images associated with a continuously guided endoscopic procedure, comprising: a memory storing a plurality of reference images of a body lumen, each reference image including a viewpoint with a depth map and image gradients; an endoscope generating at least one video frame; and a processor operative to register each video frame received from the endoscope to at least one of the reference images, the processor being programmed to perform the steps of: a) warping the video frame to the viewpoint of one reference image of the plurality of reference images or warping one reference image of the plurality of reference images at a viewpoint to the video frame; b) automatically computing an image difference between (i) the warped video frame and the reference image, or (ii) the warped reference image and the video frame; c) updating a viewpoint of the video frame using an optimization technique; and d) repeating steps a) through c) for each video frame until the viewpoint of the video frame converges on a final viewpoint or a next video frame becomes available wherein the final viewpoint gives an estimate of relative rotation and translation between the video frame and the reference image. 12. The system of claim 11, wherein at least one reference image is updated before, during, or after registration. 13. The system of claim 11, wherein the processor is further operative to receive a guess regarding an initial viewpoint of the video frame. 14. The system of claim 11, wherein the processor is further operative to use a resolution pyramid wherein all images, depth maps, and gradients are down-sampled. 15. The system of claim 11, wherein the processor is further operative to use a weighted normalized cross-correlation objective function. 16. The system of claim 11, wherein the optimization technique is based on a Gauss-Newton parameter update. 17. The system of claim 11, wherein the endoscope generates at least one live bronchoscopic video frame. 18. The system of claim 11, wherein the computed set of reference images of the body lumen comprises a 3-D model of a bronchial tree. 19. The system of claim 11, wherein the body lumen is an airway. 