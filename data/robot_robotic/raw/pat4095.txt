A facial expression recognition system that uses a face detection apparatus realizing efficient learning and high-speed detection processing based on ensemble learning when detecting an area representing a detection target and that is robust against shifts of face position included in images and capable of highly accurate expression recognition, and a learning method for the system, are provided. When learning data to be used by the face detection apparatus by Adaboost, processing to select high-performance weak hypotheses from all weak hypotheses, then generate new weak hypotheses from these high-performance weak hypotheses on the basis of statistical characteristics, and select one weak hypothesis having the highest discrimination performance from these weak hypotheses, is repeated to sequentially generate a weak hypothesis, and a final hypothesis is thus acquired. In detection, using an abort threshold value that has been learned in advance, whether provided data can be obviously judged as a non-face is determined every time one weak hypothesis outputs the result of discrimination. If it can be judged so, processing is aborted. A predetermined Gabor filter is selected from the detected face image by an Adaboost technique, and a support vector for only a feature quantity extracted by the selected filter is learned, thus performing expression recognition.
Claims What is claimed is: 1. A weak hypothesis generation apparatus for generating a weak hypothesis for estimating whether provided data is a detection target or not by using a data set including plural learning samples, each of which has been labeled as a detection target or non-detection target, the weak hypothesis generation apparatus comprising: a selection unit for selecting a part of plural hypotheses and selecting one or plural weak hypotheses having higher estimation performance than others with respect to the data set of the selected part of the hypotheses, as high-performance weak hypotheses; a new weak hypothesis generation unit for generating one or more new weak hypotheses formed by adding a predetermined modification to the high-performance weak hypotheses, as new weak hypotheses; and a weak hypothesis selection unit for selecting one weak hypothesis having the highest estimation performance with respect to the data set, from the high-performance weak hypotheses and the new weak hypotheses. 2. The weak hypothesis generation apparatus as claimed in claim 1, wherein the new weak hypothesis generation unit generates new weak hypotheses from the high-performance weak hypotheses on the basis of statistical characteristics of the detection target. 3. The weak hypothesis generation apparatus as claimed in claim 1, wherein the learning samples are images, the weak hypotheses are adapted for extracting features from a predetermined area in a provided image and estimating whether the provided image is a detection target or not, on the basis of the extracted features, and the new weak hypothesis generation unit generates the new weak hypotheses for extracting the features from a new area shifted from the predetermined area in the high-performance weak hypotheses by a predetermined quantity. 4. The weak hypothesis generation apparatus as claimed in claim 1, wherein the learning samples are images, the weak hypotheses are adapted for extracting features from a predetermined area in a provided image and estimating whether the provided image is a detection target or not, on the basis of the extracted features, and the new weak hypothesis generation unit generates the new weak hypotheses for extracting the features from a new area acquired by converting the scale of the predetermined area in the high-performance weak hypotheses to a predetermined size. 5. The weak hypothesis generation apparatus as claimed in claim 1, wherein the learning samples are images, the weak hypotheses are adapted for extracting features from a predetermined area in a provided image and estimating whether the provided image is a detection target or not, on the basis of the extracted features, and the new weak hypothesis generation unit generates the new weak hypotheses for extracting the features from a new area acquired by converting the predetermined area in the high-performance weak hypotheses utilizing symmetry of the detection target and/or the new area and the predetermined area before the conversion. 6. The weak hypothesis generation apparatus as claimed in claim 1, wherein data weighting is set for each learning sample of the data set, and estimation performance with respect to the data set is calculated on the basis of the data weighting set for each learning sample of the data set. 7. The weak hypothesis generation apparatus as claimed in claim 6, further comprising a data weighting update unit for updating the data weighting of each of the learning samples on the basis of the estimation performance with respect to the data set, of the weak hypothesis selected by the weak hypothesis selection unit. 8. The weak hypothesis generation apparatus as claimed in claim 7, wherein every time the data weighting is updated by the data weighting update unit, processing to generate a weak hypothesis by selecting one of the plural weak hypothesis is repeated. 9. The weak hypothesis generation apparatus as claimed in claim 7, wherein the data weighting update unit updates the data weighting in such a manner that the data weighting of a learning sample on which the estimation value outputted by the weak hypothesis is incorrect becomes relatively larger than the data weighting of a learning sample on which the estimation value is correct. 10. The weak hypothesis generation apparatus as claimed in claim 7, wherein the weak hypothesis deterministically outputs a result of estimation with respect to provided data. 11. The weak hypothesis generation apparatus as claimed in claim 7, wherein the weak hypothesis probabilistically outputs a result of estimation with respect to provided data. 12. The weak hypothesis generation apparatus as claimed in claim 6, wherein the data set includes a variable density image representing the detection target and a variable density image representing the non-detection target, and the weak hypothesis estimates whether a variable density image provided as an input is a detection target or not on the basis of the difference between the sum of brightness values in one or plural rectangular boxes and the sum of brightness values in the other rectangular boxes in a group of two or more rectangular boxes contained in the variable density image. 13. A weak hypothesis generation method for generating a weak hypothesis for estimating whether provided data is a detection target or not by using a data set including plural learning samples, each of which has been labeled as a detection target or non-detection target, the weak hypothesis generation method comprising: a selection step of selecting a part of plural hypotheses and selecting one or plural weak hypotheses having higher estimation performance than others with respect to the data set of the selected part of the hypotheses, as high-performance weak hypotheses; a new weak hypothesis generation step of generating one or more new weak hypotheses formed by adding a predetermined modification to the high-performance weak hypotheses, as new weak hypotheses; and a weak hypothesis selection step of selecting one weak hypothesis having the highest estimation performance with respect to the data set, from the high-performance weak hypotheses and the new weak hypotheses. 14. A weak hypothesis generation apparatus for generating a weak hypothesis for estimating whether provided data is a detection target or not by using a data set including plural learning samples each of which has been labeled as a detection target or non-detection target, the weak hypothesis generation apparatus comprising: a selection unit for selecting a part of plural weak hypotheses; a new weak hypothesis generation unit for generating one or more new weak hypotheses formed by adding a predetermined modification to the part of the weak hypotheses selected by the selection unit, as new weak hypotheses; and a weak hypothesis selection unit for selecting one weak hypothesis having the highest estimation performance with respect to the data set, from the part of the weak hypotheses selected by the selection unit and the new weak hypotheses. 15. A weak hypothesis generation method for generating a weak hypothesis for estimating whether provided data is a detection target or not by using a data set including plural learning samples each of which has been labeled as a detection target or non-detection target, the weak hypothesis generation method comprising: a selection step of selecting a part of plural weak hypotheses; a new weak hypothesis generation step of generating one or more new weak hypotheses formed by adding a predetermined modification to the part of the weak hypotheses selected at the selection step, as new weak hypotheses; and a weak hypothesis selection step of selecting one weak hypothesis having the highest estimation performance with respect to the data set, from the part of the weak hypotheses selected at the selection step and the new weak hypotheses. 