A method and system is presented for treating moving target regions in a patient's anatomy by creating radiosurgical lesions. The method includes determining a pulsating motion of a patient separately from a determining of a respiratory motion, and directing a radiosurgical beam, from a radiosurgical beam source, to a target in the patient based on the determining of the pulsating motion. Directing the radiosurgical beam to the target may include creating a lesion in the heart to inhibit atrial fibrillation. The method may further include determining the respiratory motion of the patient, and compensating for movement of the target, due to the respiratory motion and the pulsating motion of the patient, in the directing of the radiosurgical beam based on the determining of the respiratory motion and the determining of the pulsating motion.
Claims What is claimed is: 1. A method of treating a moving target in a patient by applying to said target one or more radiosurgical beams generated from a radiosurgical beam source, the method comprising: generating a pre-operative 3D scan of said target and of a surrounding region, said 3D scan indicating the position of said target relative to said surrounding region; based on said 3D scan, generating a treatment plan defining a plurality of radiosurgical beams appropriate for creating at least one radiosurgical lesion on said target; in near real time, detecting the motion of a target to determine the position of said target at a current time, and generating one or more signals representative of said motion of said target; in near real time based on the generated one or more signals, determining a difference in the position of said target at said current time, as compared to the position of said target as indicated in said 3D scan; in near real time, adjusting the relative position of said radiosurgical beam source and said target in order to accommodate for said difference, and applying x-rays to said target from said adjusted position of said radiosurgical beam source; wherein said motion of said target is a composite motion that is caused by a combination of: respiration of the patient; and pumping of the heart of the patient; and wherein generating one or more signals representative of said motion of said target comprises: establishing a look-up table of positional data for said composite motion of said data, by imaging said target and said surrounding region while the target undergoes said composite motion; establishing a look-up table of cardiac motion data for a succession of points along a heartbeat cycle of said patient, by imaging said target and said surrounding region while the patient is holding his breath; establishing a look-up table of respiratory motion data for a succession of points along a respiratory cycle of said patient, by subtracting said cardiac motion data from said positional data for said composite motion of said data; generating a first signal representative of the respiratory motion of patient from the data from said look-up table of respiratory motion, said first signal being characterized by a first frequency representative of the respiratory motion of said patient; and generating a second signal representative of the cardiac motion of said patient from the data from said look-up table of cardiac motion data, said second signal being characterized by a second frequency representative of the cardiac motion of said patient. 2. A method in accordance with claim 1, further comprising sequentially repeating detecting motion of said target and determining the difference in the position of said target during treatment, wherein said plurality of radiosurgical beams remain directed onto said target in accordance with said treatment plan throughout the duration of the treatment, and wherein said radiosurgical beam source tracks said movement of said target. 3. A method in accordance with claim 1, wherein said treatment plan comprises information regarding a number, intensities, positions, and directions of said plurality of radiosurgical beams that are effective to create said at least one lesion. 4. A method in accordance with claim 1, further comprising implanting a plurality of fiducials within said surrounding region proximate to said target, before taking said pre-operative 3D scan, wherein said position of said target as indicated in said pre-operative 3D scan is the position of the target relative to said plurality of fiducials. 5. A method in accordance with claim 1, wherein adjusting the relative position of said radiosurgical beam source and said target comprises: splitting said signal representative of said movement of said target into first and second signals; separately processing said first and second signals to remove undesired components from each signal, wherein processing said first and second signals comprises: generating a first processed signal substantially characterized by a first frequency representative of the respiratory motion of said patient, and a second processed signal substantially characterized by a second frequency representative of the pumping of the heart of said patient; generating from said first processed signal a first correction factor that is effective, when applied to a controller that controls the position of said radiosurgical beam source with respect to said target, to modify the position of said radiosurgical beam source relative to said target to account for the movement of said target due to respiration of said patient; generating from said second processed signal a second correction factor that is effective, when applied to said controller, to modify the position of said radiosurgical beam source relative to said target to account for the movement of said target due to the pumping of the heart of said patient; superposing said first and second correction factors, to generate a combined correction factor that is effective, when applied to said controller, to modify the position of said radiosurgical beam source relative to said target to account for said composite motion of said target region caused by both respiration and cardiac pumping. 6. A method in accordance with claim 5, wherein said first signal and said second signal are substantially decoupled and mutually orthogonal. 7. A method in accordance with claim 5, wherein processing said first and second signals comprises using an adaptive filter to filter out noise. 8. A method in accordance with claim 5, wherein processing said first and second signals comprise using one or more noise-canceling algorithms for eliminating one or more undesired frequency components. 9. A method in accordance with claim 8, wherein said one or more noise-canceling algorithms are effective to: extract said one or more undesired frequency components; invert said extracted frequency components; and generate one or more signals that cancels said one or more undesired frequency components. 10. A method in accordance with claim 5, wherein said respiratory motion is characterized by a respiratory cycle, and wherein said first correction factor is a relatively static factor that accounts for motion of said target during only a selected portion of said respiratory cycle. 11. A method in accordance with claim 10, wherein said selected portion of said respiratory cycle is centered about a peak within said respiratory cycle. 12. A method in accordance with claim 5, wherein generating said first correction factor comprises: digitally comparing said one or more near real-time x-ray images with said pre-operative 3D scan to compute the difference in position between the position of the target as indicated in the pre-operative 3D scan as compared to the position of the target in said near real-time x-ray images. 13. A method in accordance with claim 12, wherein digitally comparing said near real-time x-ray images comprises: generating one or more digitally reconstructed radiographs (DRRs) using the pre-operative 3D scan together with said known beam paths and intensities of said x-ray imaging beams; computing changes in position and orientation of said target in the one or more DRRs in order to bring said one or more DRRs in registration with said one or more real-time x-ray images. 14. A method of treating a moving target in a patient by applying one or more radiosurgical beams, generated from a radiosurgical beam source, to said target, the method comprising: generating a treatment plan containing information defining the positions, angles, and intensities of one or more radiosurgical beams that are adapted to create, when applied to said target, at least one radiosurgical lesion, said treatment plan being based on 3D scan data that indicates the position of said target at treatment planning time; in near real time, monitoring the motion of said target to determine the difference between the position of the target at a current time, as compared to the position of said target at treatment planning time as indicated by said 3D scan data; in near real time, adjusting the relative position of the radiosurgical beam source and said target to account for the difference in target position using a robotic controller; and applying one or more radiosurgical beams from said adjusted position of said radiosurgical beam source; and wherein said motion of said target is caused by the respiration and the heart beat of said patient; and wherein the adjusting said relative position of said radiosurgical beam source to account for the difference in target position comprises: sensing the motion of said target during a time interval, using a breathing sensor and a heart beat sensor; extrapolating said motion into a complete cycle; and synchronizing said robotic controller with said extrapolated motion of said target. 15. A system for treating a moving target in a patient by forming a radiosurgical lesion on said target, the system comprising: an apparatus for generating 3D scan data representative of a pre-operative 3D diagnostic image of said target and a surrounding region; a processor including treatment planning software for generating, based on said 3D scan data, a base treatment plan defining a plurality of x-ray beams appropriate for creating at least one lesion in said target; a beam source for generating one or more radiosurgical beams adapted to create at least one lesion in said target; a positioning system that controls the relative position of said beam source and said target; imaging means for generating at least one real-time x-ray image of said target; means for sensing the motion of said target, and for generating at least one signal representative of said motion; and means for generating from said at least one signal at least one correction factor that is effective, when applied to said positioning system, to modify the position of said beam source relative to said target to accommodate for the difference in position of said target at a current time as compared to the position of said target in said pre-operative diagnostic image; a signal processor coupled to the processor, the signal processor to process said at least one signal to generate a first signal substantially characterized by a first frequency, and a second signal substantially characterized by a second frequency; means for generating from said first signal a first correction factor, and for generating from said second signal a second correction factor; and means for superposing said first correction factor and said second correction factor to obtain said correction factor that is effective, when applied to said positioning system, to modify the position of said beam source relative to said target so as to accommodate for the difference in position of said target at a current time as compared to the position of said target in said pre-operative diagnostic image. 16. A system in accordance with claim 15, wherein said motion of said target is caused by respiration of said patient and by the pumping of the heart of said patient, and wherein said means for sensing the motion of said target includes a breathing sensor for sensing the respiration of said patient, and a heart rate monitor for monitoring the cardiac pumping of said patient. 17. A system in accordance with claim 15, wherein said first frequency is representative of the respiratory motion of said patient, and said second frequency is representative of the cardiac pumping motion of said patient. 18. A system in accordance with claim 15, wherein said first correction factor is a relatively static factor that accounts for motion of said target during only a portion of said respiratory cycle. 19. A system in accordance with claim 15, wherein said positioning system is an industrial robot having an articulated arm assembly, and wherein said radiosurgical beam source is an x-ray linac mounted at one end of said articulated arm assembly of said robot. 20. A system in accordance with claim 15, wherein said positioning system is effective, in response to receipt of said correction factor, to modify the position of said beam source in such a way that said radiosurgical beam source tracks the motion of said target. 21. A system in accordance with claim 15, wherein said imaging means comprises: one or more x-ray sources to generate x-ray imaging beams; and one or more corresponding x-ray detectors to detect said imaging beams after said imaging beams have traversed said target. 22. A system in accordance with claim 15 wherein said pre-operative 3D scan data comprise at least one of CT scan data; PET scan data; or MRI scan data. 23. A system in accordance with claim 15, wherein said means for generating said first correction factor comprises means for digitally comparing said one or more near real-time x-ray images with said pre-operative 3D scan to calculate the difference in position between the position of the target as indicated in the pre-operative 3D scan as compared to the position of the target in said near real-time x-ray images. 24. A system in accordance with claim 23, wherein said means for digitally comparing said one or more near real-time x-ray images with said 3D scan comprises: means for generating one or more DRRs using the 3D scan together with information regarding the beam paths and intensities of said x-ray imaging beams; and computing the changes in position and orientation of said target that are necessary in order to bring said one or more DRRs in registration with said one or more real-time x-ray images. 25. A system in accordance with claim 15, wherein said signal processor comprises: means for splitting said at least one signal into first and second signals; means for processing said first and second signals to remove undesired components from each signal, so as to generate said first signal substantially characterized by a first frequency, and said second signal substantially characterized by a second frequency. 26. A system in accordance with claim 25, wherein said means for processing said first and second signals comprises an adaptive filter for filtering out noise. 27. A system in accordance with claim 25, wherein said means for processing said first and second signals comprises software that includes one or more noise-canceling algorithms for eliminating one or more undesired frequency components, and wherein said one or more noise-canceling algorithms are effective to: extract said undesired frequency components; invert said extracted frequency components; and generate one or more signals that cancel said undesired frequency components. 