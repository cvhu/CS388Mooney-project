Provided is a controller arrangement for an optical sensing pen having a nib. The controller arrangement is configured to operatively sense location data by sensing location tags on a page of printed media, and to calculate an orientation of the pen and a nib-to-tag distance. The controller arrangement includes an infrared (IR) illumination LED and image sensor assembly configured to transmit IR light onto, and receive IR light reflected from, respectively, the page of printed media. The controller arrangement also includes a force sensing infrared LED and photodiode assembly configured to detect when the nib contacts the page so that the sensor assembly is only activated when the nib is in contact with said page, and an accelerometer configured to allow the controller to sense motion without reference to the location tags. The controller arrangement further includes a transceiver and antenna assembly, and a processor arranged in signal communication with, and configured to control, the sensor assembly, the photodiode assembly, the accelerometer and antenna assembly to operatively calculate the orientation of the pen and the nib-to-tag distance, and to transmit the location data to a computing system.
Claims The invention claimed is: 1. A controller arrangement for an optical sensing pen having a nib, the controller arrangement configured to operatively sense location data by sensing location tags on a page of printed media, and to calculate an orientation of the pen and a nib-to-tag distance, said controller arrangement comprising: an infrared (IR) illumination LED and image sensor assembly configured to transmit IR light onto, and receive IR light reflected from, respectively, the page of printed media; a force sensing infrared LED and photodiode assembly configured to detect when the nib contacts the page so that the sensor assembly is only activated when the nib is in contact with said page; an accelerometer configured to allow the controller to sense motion without reference to the location tags; a transceiver and antenna assembly; and a processor arranged in signal communication with, and configured to control, the sensor assembly, the photodiode assembly, the accelerometer and antenna assembly to operatively calculate the orientation of the pen and the nib-to-tag distance, and to transmit the location data to a computing system. 2. The controller arrangement of claim 1, wherein the processor is configured to encrypt the location data prior to transmission thereof to the computing system. 3. The controller arrangement of claim 1, having a buffer wherein the processor is configured to buffer the location data when the pen is out of transmission range of the computing system. 4. The controller arrangement of claim 1, having a tri-color status LED under control of the processor to indicate a status of the controller arrangement. 5. The controller arrangement of claim 1, having a bus via which an exchange of data between components of the controller arrangement occurs, and an analog-to-digital converter arranged to convert analog signals from the photodiode assembly to a digital signal. 6. The controller arrangement of claim 1, wherein the transceiver and antenna assembly includes a radio frequency (RF) circuit and RF resonators and inductors connected to an antenna. 7. The controller arrangement of claim 1, wherein the processor includes a medium-performance general-purpose RISC processor configured to operate at a frequency of approximately 40 MHz. 