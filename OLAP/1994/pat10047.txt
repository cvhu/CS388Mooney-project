The present method and apparatus determines an interference-free trajectory for fitting a moving solid body into a cavity, particularly where the body has a complex shape and tightly fits into the cavity. The method begins by describing the body surface with a finite set of body surface elements and the cavity surface with a finite set of cavity surface elements. Then a set of surface element pairs is determined. Each set comprises a body surface element and a corresponding cavity surface element. A neighborhood is a volume that contains the pair of surface elements but no other surface element pairs or parts of surface elements. Body motion constraints are developed for each pair. The constraints do not allow the body motion to cause the surface elements in the pair to interpenetrate or to leave their respective neighborhood. An incremental movement of the body, along a preferred direction, is then determined subject to the constraints. The body is moved the incremental amount and the process is repeated with a new set of pairs. Apparatus using the method can without interferences insert bodies into cavities or design and/or manufacture bodies and/or cavities with interference-free insertion trajectories. The invention has specific application to the design and insertion of prosthetic implants.
Claims We claim: 1. A method for determining an interference-free insertion trajectory of a moving solid body within a cavity, the body being described by a body surface, the cavity being described by cavity surface, the body having configurations with respect to the cavity, the configurations having a position and orientation, and moving the body from a start configuration, through intermediate configurations, to a final configuration, the method comprising the steps of: (a) describing the body surface by a finite set of body surface elements and the cavity surface by a finite set of cavity surface elements; (b) determining a set of surface element pairs at the body start configuration, each pair comprising a body surface element and a corresponding cavity surface element, the body and cavity surface elements being paired such that the distance between the body surface element of the pair and the cavity element of the pair is smaller than the distance between the body element of the pair and any other cavity element; (c) defining a neighborhood for every surface element pair so that the neighborhood contains the body and cavity surface elements in the pair but no other surface elements or parts of surface elements belonging another surface element pair; (d) determining body motion constraints for every surface element pair so that each paired body and the cavity surface element do not interpenetrate and that the body movement does not cause the body surface element in the pair to leave the neighborhood; (e) determining an incremental movement of the body so that the incremental movement satisfies the body motion constraints and the incremental movement is along a defined preferred motion direction; (f) moving the body to a new body configuration by moving the body the incremental body movement; and (g) repeating steps (b) through (f) with the new body configuration until the final body configuration is reached or until a stuck body configuration is attained. 2. A method, as in claim 1, where the start configuration is outside the cavity and the final configuration is a tight fit within the cavity. 3. A method, as in claim 1, where the final configuration is within the cavity and the final configuration is outside the cavity. 4. A method, as in claim 1, where the distance between the cavity and body elements of the pair is smaller than the distance between the cavity element of the pair and any other body element. 5. A method, as in claim 1, where the body surface elements are points on the body surface obtained by sampling the body surface at regular intervals with a grid covering the body surface in its entirety. 6. A method, as in claim 1, where the cavity surface elements are planar facets on the cavity surface obtained by sampling the cavity surface at regular intervals with a grid covering the cavity shape in its entirety. 7. A method, as in claim 1, where the neighborhoods of the surface element pairs are pie-slice shaped volumes each having one wall that is a planar facet defined by a cavity surface element. 8. A method, as in claim 1, where the body surface elements are points on the body surface obtained by sampling the body surface at regular intervals with a grid covering the body shape in its entirety, the cavity surface elements are planar facets on the cavity surface obtained by sampling the cavity surface at regular intervals with a grid covering the cavity shape in its entirety, the neighborhoods of the surface element pairs are pie-slice shaped volumes each having one wall being a planar facet defined by a cavity surface element, and body motion constraints are linearized. 9. A method, as in claim 1, where the incremental movement of the body is defined by a linear function and the preferred motion direction is along an axis of the cavity. 10. A method, as in claim 1, where the incremental movement of the body is optimized by solving an optimization problem in which an objective function is a function describing the preferred motion direction and the constraints are the body motion constraints, the surface element pair neighborhoods, and one or more imposed small motion constraints. 11. A method, as in claim 10, where the direction function is a quadratic function that minimizes body rotations while maximizing the axial motion of the body. 12. A method, as in claim 10, where the direction function is linearized and the optimization problem is linear. 13. A method, as described in claim 12, where the linear optimization problem is solved with a linear programming technique. 14. A method, as in claim 10, where the optimization problem is quadratic. 15. A method, as in claim 14, where the optimization problem is solved with a non-negative least squares technique. 16. A method, as in claim 1, where the body and the cavity are slightly compressible. 17. A method, as in claim 1, where the body motion constraints are augmented with a set of user defined constraints and requirements on the characteristics of the body insertion motion. 18. A method, as in claim 1, where the body is an prosthetic implant and the cavity exists in an anatomical structure. 19. A method for designing and modifying an insertable body shape and a cavity shape and determining an interference-free body insertion trajectory, the body shape being initially described by a nominal body surface, the cavity shape being initially described by nominal cavity surface, and the body being moved from a start configuration, through intermediate configurations, to a final configuration, the method comprising the steps of: (a) determining an interference-free insertion trajectory of the moving solid body into the cavity or an intermediate stuck configuration, the determination made by the following steps: (1) describing the body shape by a finite set of body surface elements and the cavity shape by a finite set of cavity surface elements; (2) determining a set of surface element pairs at the body start configuration, each pair comprising a body surface element and a corresponding cavity surface element, the body and cavity surface elements being paired such that the distance between the body surface element of the pair and the cavity element of the pair is smaller than the distance between the body element of the pair and any other cavity element; (3) defining a neighborhood for every surface element pair so that the neighborhood contains the body and cavity surface elements in the pair but no other surface elements or parts of surface elements belonging another surface element pair; (4) determining body motion constraints for every surface element pair so that each paired body and the cavity surface element do not interpenetrate and that the body movement does not cause the body surface element in the pair to leave the neighborhood; (5) determining an incremental movement of the body so that the incremental movement satisfies the body motion constraints and the incremental movement is along a defined preferred motion direction; (6) moving the body to a new body configuration by moving the body the incremental body movement; and (7) repeating steps (2) through (6) with the new body configuration until the final body configuration is reached or until a stuck body configuration is attained; (b) determining if the body has reached its final configuration or is in a stuck configuration; (c) identifying the interferences between the body and the cavity that prevent the body from continuing on its insertion trajectory when the body is stuck; (d) modifying the body and cavity shapes to remove the interferences so as to allow the body to continue in its insertion trajectory; and (e) repeating steps (a) through (d) until the body reaches its final configuration inside the cavity. 20. A method, as in claim 19, where the nominal body and cavity shapes are derived from a shape template and a shape template complement. 21. A method, as in claim 19, where the body and cavity modifications are dictated by a human designer after the interferences and the body and cavity surfaces causing them have been identified. 22. A method, as in claim 19, where the body and cavity modifications are automatically made based on diverse shape design and modification criteria. 23. A method, as in claim 19, where the body and cavity modifications are automatically made using shape relaxation techniques. 24. A method, as in claim 19, where the interferences between the body and the cavity are identified by optimizing a function describing a preferred direction of body motion. 25. A method, as in claim 19, where the body is an prosthetic implant and the cavity exists in an anatomical structure. 26. A method for inserting without interferences a moving solid body into a cavity by having a computer-controlled end effector follow an interference-free body insertion trajectory, the body being described by a body surface, the cavity being described by cavity surface, and the body being moved from a start configuration, through intermediate configurations, to a final configuration, the method comprising the steps of: (a) describing the body surface shape by a finite set of body surface elements and the cavity surface shape by a finite set of cavity surface elements; (b) determining a set of surface element pairs at the body start configuration, each pair comprising a body surface element and a corresponding cavity surface element, the body and cavity surface elements being paired such that the distance between the body surface element of the pair and the cavity surface element of the pair is smaller than the distance between the body surface element of the pair and any other cavity surface element; (c) defining a neighborhood for every surface element pair so that the neighborhood contains the body and cavity surface elements in the pair but no other surface elements or parts of surface elements belonging another surface element pair; (d) determining body motion constraints for every surface element pair so that the body and the cavity do not interpenetrate and the body movement does not cause the body surface element in the pair to leave the neighborhood; (e) determining an incremental movement of the body so that the incremental movement satisfies the body motion constraints and the incremental movement is along a defined preferred motion direction; (f) simulate moving the body to a new configuration an amount of the incremental body movement; (g) repeating steps (b) through (f) with the new body configuration until the final body configuration is reached and an interference-free trajectory is defined or until a stuck body configuration is attained; and (h) executing the interference-free body insertion trajectory on the end effector. 27. A method, as in claim 26, where the body is a prosthetic implant and the cavity exists in an anatomical structure. 28. A method, as in claim 26, having the additional steps of: (i) monitoring any insertion forces on the body; and (k) modifying the trajectory base on the monitored forces. 29. An apparatus for the precise interference-free insertion of a body into a cavity, comprising: (a) a computer-controlled positioning and manipulation device to insert the body into the cavity; (b) a CAD system to define the body and cavity shapes; and (c) a computer that determines the interference-free body insertion trajectory from the body and cavity shapes defined by the CAD system and drives the positioning and manipulation device along the trajectory, the trajectory determined by the following steps: (1) describing a body surface by a finite set of body surface elements and a cavity surface by a finite set of cavity surface elements; (2) determining a set of surface element pairs at the body start configuration, each pair comprising a body surface element and a corresponding cavity surface element, the body and cavity surface elements being paired such that the distance between the body surface element of the pair and the cavity element of the pair is smaller than the distance between the body element of the pair and any other cavity element; (3) defining a neighborhood for every surface element pair so that the neighborhood contains the body and cavity surface elements in the pair but no other surface elements or parts of surface elements belonging another surface element pair; (4) determining body motion constraints for every surface element pair so that each paired body and the cavity surface element do not interpenetrate and that the body movement does not cause the body surface element in the pair to leave the neighborhood; (5) determining an incremental movement of the body so that the incremental movement satisfies the body motion constraints and the incremental movement is along a defined preferred motion direction; (6) moving the body to a new body configuration by moving the body the incremental body movement; and (7) repeating steps (2) through (6) with the new body configuration until the final body configuration is reached or until a stuck body configuration is attained. 30. An apparatus as in claim 29, where the end effector is a robotic arm specifically designed for the insertion task, the body is a prosthetic implant, and the cavity exists in an anatomical structure. 31. An apparatus for the design and manufacturing of insertable body and cavity shapes, comprising: (a) a numerically-controlled machining device for the manufacturing of the body and cavity; (b) a CAD system to define and modify the body and cavity shapes; and (c) a computer for determining an interference-free body insertion trajectory and designing and modifying the insertable body and cavity shapes to conform to the trajectory, the trajectory determined by the following steps: (1) describing the body shape by a finite set of body surface elements and the cavity shape by a finite set of cavity surface elements; (2) determining a set of surface element pairs at the body start configuration, each pair comprising a body surface element and a corresponding cavity surface element, the body and cavity surface elements being paired such that the distance between the body surface element of the pair and the cavity element of the pair is smaller than the distance between the body element of the pair and any other cavity element; (3) defining a neighborhood for every surface element pair so that the neighborhood contains the body and cavity surface elements in the pair but no other surface elements or parts of surface elements belonging another surface element pair; (4) determining body motion constraints for every surface element pair so that each paired body and the cavity surface element do not interpenetrate and that the body movement does not cause the body surface element in the pair to leave the neighborhood; (5) determining an incremental movement of the body so that the incremental movement satisfies the body motion constraints and the incremental movement is along a defined preferred motion direction; (6) moving the body to a new body configuration by moving the body the incremental body movement; and (7) repeating steps (2) through (6) with the new body configuration until the final body configuration is reached or until a stuck body configuration is attained. 32. An apparatus, as in claim 31, where the machining device is a 3-dimensional printing device. 33. An apparatus, as in claim 31, where the body is a prosthetic implant and the cavity exists in an anatomical structure. 