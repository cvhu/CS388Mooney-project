A robotic system for steering a flexible needle during insertion into soft-tissue using imaging to determine the needle position. The control system calculates a needle tip trajectory that hits the desired target while avoiding potentially dangerous obstacles en route. Using an inverse kinematics algorithm, the maneuvers required of the needle base to cause the tip to follow this trajectory are calculated, such that the robot can perform controlled needle insertion. The insertion of a flexible needle into a deformable tissue is modeled as a linear beam supported by virtual springs, where the stiffness coefficients of the springs varies along the needle. The forward and inverse kinematics of the needle are solved analytically, enabling both path planning and correction in real-time. The needle shape is detected by image processing performed on fluoroscopic images. The stiffness properties of the tissue are calculated from the measured shape of the needle.
Claims The invention claimed is: 1. A system for the insertion of a needle having a tip into a tissue, according to a predetermined trajectory, comprising: a robot for maneuvering said needle into said tissue; an imaging system for ascertaining the trajectory of said needle in real time; and a control system controlling said robot motion according to differences between said ascertained trajectory and said predetermined trajectory, wherein said controller utilizes a model of said needle as a flexible beam having a plurality of virtual springs each having a coefficient of stiffness connected laterally thereto to simulate lateral forces exerted by said tissue on said needle, and whose trajectory through said tissue is determined by the influence of said plurality of virtual springs on said needle, and wherein said system determines the needle trajectory taking into account the change in the stiffness coefficients of at least some of said virtual springs as a result of the trajectory of said needle and said control system utilizes an inverse kinematics solution applied to said virtual springs model to calculate the required motion to be imparted to said needle to follow said planned trajectory. 2. A system according to claim 1 wherein said system determines the needle trajectory taking into account the effect of motion of said tissue as a result of insertion of said needle. 3. A system according to claim 1, wherein said robot motion comprises at least some of inward, lateral and angular motion. 4. A system according to claim 3, wherein said robot motion comprises up to 6 degrees of freedom. 5. A system according to claim 1 wherein said imaging system is any one of an X-ray fluoroscopic system, a CT system, an MRI system, an ultrasonic system, a system using electromagnetic navigation, and a system using optical navigation. 6. A system according to claim 1 wherein said imaging system is aligned to provide images of a plane generally including the directions of said lateral and inward motion. 7. A system according to claim 1 wherein said control system determines the deviation of the real time position of said tip determined by image processing of an image obtained from said imaging system, from the planned position of said tip according to said predetermined trajectory, and calculates the motion to be applied to said robot to reduce said deviation by use of said virtual springs model. 8. A system according to claim 1, wherein said predetermined trajectory is divided into increments, and the control system performs the insertion according to these increments, and in accordance with the real time results obtained at least from the imaging system at each incremental insertion point. 9. A system according to claim 1, further comprising a registration system such that the co-ordinate system of said robot, to which said needle is attached, can be related to the co-ordinate system of the imaging system. 10. A system according to claim 1, wherein said predetermined trajectory of said needle comprises a target for said tip of said needle. 11. A system according to claim 10 wherein said predetermined trajectory is adapted to avoid at least one region where access is forbidden to said needle. 12. A system according to claim 1 wherein said control system uses the shape of the needle as detected from the images, to determine in real time changes in the stiffness properties of the tissue which the needle is traversing. 13. A system according to claim 12 and wherein said control system uses these changed tissue properties to adjust the needle path in real time in accordance with the tissue being negotiated. 14. A system according to claim 12, further comprising a force sensor to determine the forces exerted on said needle at its base, and wherein said control system also uses said forces to determine in real time changes in the stiffness properties of the tissue which the needle is traversing. 15. A system for the insertion of a needle having a tip into a tissue, according to a predetermined trajectory, comprising: a robot for maneuvering said needle into said tissue; a plurality of position sensors disposed along said needle for ascertaining the trajectory of said needle in real time; a registration system to relate a co-ordinate system of said robot to which said needle is attached to the ascertained position of the needle; and a control system controlling said robot motion according to differences between said ascertained trajectory and said predetermined trajectory, wherein said controller utilizes a model of said needle as a flexible beam having a plurality of virtual springs each having a coefficient of stiffness connected laterally thereto to simulate lateral forces exerted by said tissue on said needle, and whose trajectory through said tissue is determined by the influence of said plurality of virtual springs on said needle, and wherein said system determines the needle trajectory taking into account the change in the stiffness coefficients of at least some of said virtual springs as a result of the trajectory of said needle, such that the position of said needle can be determined without the use of X-ray imaging and said control system utilizes an inverse kinematics solution applied to said virtual springs model to calculate the required motion to be imparted to said needle to follow said planned trajectory. 16. A system according to claim 15, wherein said at least one position sensor is an electromagnetic position sensor. 17. A system for controlling the insertion of a needle into a deformable tissue, according to a predetermined trajectory, comprising: a robot for maneuvering said needle into said tissue; an imaging system for ascertaining the trajectory of said needle in real time; and a control system adapted to control said robot motion according to differences between said ascertained trajectory and said predetermined trajectory; wherein said control system is adapted to: (i) use the trajectory of the imaged needle to determine changes in the elastic properties of the tissue along the path through which the needle is passing; ii) utilize these tissue properties to adjust, according to the tissue being negotiated, an elastic model of the tissue along the path of the needle, said elastic model being based on a plurality of virtual springs, each having a coefficient of stiffness, said springs acting on the needle modeled as a flexible beam; (iii) obtain an inverse kinematic solution for the motion of said needle along its path through said tissue; and (iv) instructs said robot to maneuver said needle into said tissue according to said solutions, and wherein said system determines the needle trajectory in accordance with changes in said elastic model of the tissue, as the needle passes through said tissue. 18. A system according to claim 17, and further comprising a force sensor to determine the forces exerted on said needle at its base, and wherein said control system is adapted to performs the additional step of also using said forces to determine changes in the elastic properties of the tissue which the needle is traversing. 19. A system according to claim 17, and wherein said predetermined trajectory is divided into increments, and said control system performs said insertion incrementally according to the real time results obtained from said imaging system. 20. A method of controlling the insertion of a needle into a tissue, comprising the steps of: determining a preplanned trajectory to be followed by said needle; mounting the base of said needle on a robot for maneuvering said needle into said tissue; generating images of said tissue to show the trajectory of said needle in real time; controlling the motion of said robot according to differences between said real-time trajectory and said preplanned trajectory; and utilizing a model of said needle as a flexible beam having a plurality of virtual springs each having a coefficient of stiffness connected laterally thereto to simulate lateral forces exerted by said tissue on said needle, and calculating said trajectory through said tissue on the basis of the influence of changes in the coefficient of stiffness of at least some of said plurality of virtual springs on said needle and said control system utilizes an inverse kinematics solution applied to said virtual springs model to calculate the required motion to be imparted to said needle to follow said planned trajectory. 